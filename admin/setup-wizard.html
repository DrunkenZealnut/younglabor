<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin System 설정 마법사</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <style>
        :root {
            --primary: #0d6efd;
            --secondary: #6c757d;
            --success: #198754;
            --info: #0dcaf0;
            --warning: #ffc107;
            --danger: #dc3545;
            --light: #f8f9fa;
            --dark: #212529;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .wizard-container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .wizard-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .wizard-header h1 {
            margin: 0;
            font-size: 2rem;
            font-weight: 300;
        }
        
        .wizard-header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
        }
        
        .wizard-steps {
            display: flex;
            justify-content: space-around;
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
        }
        
        .wizard-step {
            flex: 1;
            text-align: center;
            padding: 10px;
            position: relative;
            cursor: pointer;
        }
        
        .wizard-step::after {
            content: '';
            position: absolute;
            top: 35px;
            right: -50%;
            width: 100%;
            height: 2px;
            background: #dee2e6;
            z-index: 0;
        }
        
        .wizard-step:last-child::after {
            display: none;
        }
        
        .wizard-step .step-icon {
            width: 60px;
            height: 60px;
            background: white;
            border: 3px solid #dee2e6;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: #6c757d;
            position: relative;
            z-index: 1;
            transition: all 0.3s ease;
        }
        
        .wizard-step.active .step-icon {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
            transform: scale(1.1);
        }
        
        .wizard-step.completed .step-icon {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }
        
        .wizard-step .step-title {
            margin-top: 10px;
            font-weight: 600;
            color: #6c757d;
        }
        
        .wizard-step.active .step-title {
            color: var(--primary);
        }
        
        .wizard-step.completed .step-title {
            color: var(--success);
        }
        
        .wizard-body {
            padding: 30px;
            min-height: 400px;
        }
        
        .wizard-footer {
            padding: 20px 30px;
            background: #f8f9fa;
            border-top: 1px solid #dee2e6;
            display: flex;
            justify-content: space-between;
        }
        
        .step-content {
            display: none;
            animation: fadeIn 0.5s;
        }
        
        .step-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .config-preview {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .color-preview {
            width: 30px;
            height: 30px;
            border-radius: 5px;
            border: 1px solid #dee2e6;
            display: inline-block;
            vertical-align: middle;
            margin-left: 10px;
        }
        
        .test-connection-result {
            margin-top: 15px;
            padding: 10px;
            border-radius: 5px;
            display: none;
        }
        
        .test-connection-result.success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        
        .test-connection-result.error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        
        .download-section {
            text-align: center;
            padding: 30px;
        }
        
        .download-button {
            margin: 10px;
            padding: 15px 30px;
            font-size: 1.1rem;
        }
        
        .file-icon {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .installation-guide {
            background: #f8f9fa;
            border-left: 4px solid var(--info);
            padding: 15px;
            margin-top: 20px;
        }
        
        .preset-buttons {
            margin-bottom: 20px;
        }
        
        .preset-buttons .btn {
            margin: 5px;
        }
        
        input[type="color"] {
            width: 50px;
            height: 38px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .form-label {
            font-weight: 600;
            color: #495057;
        }
        
        .form-text {
            font-size: 0.875rem;
            color: #6c757d;
        }
        
        .alert-icon {
            font-size: 1.5rem;
            margin-right: 10px;
            vertical-align: middle;
        }
    </style>
</head>
<body>
    <div class="wizard-container">
        <!-- Header -->
        <div class="wizard-header">
            <h1><i class="bi bi-gear-fill"></i> Admin System 설정 마법사</h1>
            <p>서버 설치 전 필요한 설정 파일을 생성합니다</p>
        </div>
        
        <!-- Steps -->
        <div class="wizard-steps">
            <div class="wizard-step active" data-step="1">
                <div class="step-icon">
                    <i class="bi bi-database"></i>
                </div>
                <div class="step-title">데이터베이스</div>
            </div>
            <div class="wizard-step" data-step="2">
                <div class="step-icon">
                    <i class="bi bi-gear"></i>
                </div>
                <div class="step-title">애플리케이션</div>
            </div>
            <div class="wizard-step" data-step="3">
                <div class="step-icon">
                    <i class="bi bi-palette"></i>
                </div>
                <div class="step-title">테마</div>
            </div>
            <div class="wizard-step" data-step="4">
                <div class="step-icon">
                    <i class="bi bi-shield-check"></i>
                </div>
                <div class="step-title">보안</div>
            </div>
            <div class="wizard-step" data-step="5">
                <div class="step-icon">
                    <i class="bi bi-download"></i>
                </div>
                <div class="step-title">다운로드</div>
            </div>
        </div>
        
        <!-- Body -->
        <div class="wizard-body">
            <!-- Step 1: Database -->
            <div class="step-content active" id="step1">
                <h3><i class="bi bi-database"></i> 데이터베이스 설정</h3>
                <p class="text-muted">MySQL/MariaDB 연결 정보를 입력하세요.</p>
                
                <div class="row mt-4">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">호스트</label>
                            <input type="text" class="form-control" id="db_host" value="localhost">
                            <small class="form-text">데이터베이스 서버 주소</small>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">포트</label>
                            <input type="number" class="form-control" id="db_port" value="3306">
                            <small class="form-text">MySQL 기본 포트: 3306</small>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">데이터베이스명</label>
                            <input type="text" class="form-control" id="db_name" placeholder="예: woodong615">
                            <small class="form-text">사용할 데이터베이스 이름</small>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Unix 소켓 (선택)</label>
                            <input type="text" class="form-control" id="db_socket" placeholder="예: /tmp/mysql.sock">
                            <small class="form-text">XAMPP: /Applications/XAMPP/xamppfiles/var/mysql/mysql.sock</small>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">사용자명</label>
                            <input type="text" class="form-control" id="db_user" value="root">
                            <small class="form-text">데이터베이스 사용자</small>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">비밀번호</label>
                            <input type="password" class="form-control" id="db_password">
                            <small class="form-text">비어있을 수 있습니다</small>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">테이블 프리픽스</label>
                            <input type="text" class="form-control" id="db_prefix" value="admin_">
                            <small class="form-text">테이블명 앞에 붙을 문자</small>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">문자셋</label>
                            <select class="form-select" id="db_charset">
                                <option value="utf8mb4" selected>utf8mb4 (권장)</option>
                                <option value="utf8">utf8</option>
                                <option value="latin1">latin1</option>
                            </select>
                            <small class="form-text">한글 지원: utf8mb4</small>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Step 2: Application -->
            <div class="step-content" id="step2">
                <h3><i class="bi bi-gear"></i> 애플리케이션 설정</h3>
                <p class="text-muted">시스템 기본 정보를 설정합니다.</p>
                
                <div class="row mt-4">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">애플리케이션 이름</label>
                            <input type="text" class="form-control" id="app_name" value="Admin System">
                            <small class="form-text">관리자 시스템 이름</small>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">환경</label>
                            <select class="form-select" id="app_env">
                                <option value="local">Local (개발)</option>
                                <option value="development">Development (개발서버)</option>
                                <option value="staging">Staging (스테이징)</option>
                                <option value="production" selected>Production (운영)</option>
                            </select>
                            <small class="form-text">실행 환경 선택</small>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">디버그 모드</label>
                            <select class="form-select" id="app_debug">
                                <option value="false" selected>비활성화 (권장)</option>
                                <option value="true">활성화</option>
                            </select>
                            <small class="form-text">운영 환경에서는 비활성화</small>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">사이트 URL</label>
                            <input type="url" class="form-control" id="app_url" value="http://localhost">
                            <small class="form-text">전체 URL 주소</small>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">사이트명</label>
                            <input type="text" class="form-control" id="site_name" value="My Admin Site">
                            <small class="form-text">사이트 기본 이름</small>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">관리자 이메일</label>
                            <input type="email" class="form-control" id="admin_email" value="admin@example.com">
                            <small class="form-text">시스템 알림 수신 이메일</small>
                        </div>
                    </div>
                </div>
                
                <div class="alert alert-info mt-3">
                    <i class="bi bi-info-circle alert-icon"></i>
                    <strong>팁:</strong> 개발 환경에서는 디버그 모드를 활성화하면 상세한 오류 메시지를 볼 수 있습니다.
                </div>
            </div>
            
            <!-- Step 3: Theme -->
            <div class="step-content" id="step3">
                <h3><i class="bi bi-palette"></i> 테마 설정</h3>
                <p class="text-muted">시스템 색상 테마를 선택하세요.</p>
                
                <div class="preset-buttons">
                    <button class="btn btn-outline-primary" onclick="applyPreset('bootstrap')">
                        <i class="bi bi-bootstrap"></i> Bootstrap
                    </button>
                    <button class="btn btn-outline-primary" onclick="applyPreset('material')">
                        <i class="bi bi-palette2"></i> Material
                    </button>
                    <button class="btn btn-outline-primary" onclick="applyPreset('dark')">
                        <i class="bi bi-moon-fill"></i> Dark
                    </button>
                    <button class="btn btn-outline-primary" onclick="applyPreset('custom')">
                        <i class="bi bi-brush"></i> Custom
                    </button>
                </div>
                
                <div class="row mt-4">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">Primary 색상</label>
                            <div class="input-group">
                                <input type="color" id="color_primary" value="#0d6efd">
                                <input type="text" class="form-control" id="color_primary_text" value="#0d6efd">
                                <span class="color-preview" id="preview_primary"></span>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Secondary 색상</label>
                            <div class="input-group">
                                <input type="color" id="color_secondary" value="#6c757d">
                                <input type="text" class="form-control" id="color_secondary_text" value="#6c757d">
                                <span class="color-preview" id="preview_secondary"></span>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Success 색상</label>
                            <div class="input-group">
                                <input type="color" id="color_success" value="#198754">
                                <input type="text" class="form-control" id="color_success_text" value="#198754">
                                <span class="color-preview" id="preview_success"></span>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Info 색상</label>
                            <div class="input-group">
                                <input type="color" id="color_info" value="#0dcaf0">
                                <input type="text" class="form-control" id="color_info_text" value="#0dcaf0">
                                <span class="color-preview" id="preview_info"></span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">Warning 색상</label>
                            <div class="input-group">
                                <input type="color" id="color_warning" value="#ffc107">
                                <input type="text" class="form-control" id="color_warning_text" value="#ffc107">
                                <span class="color-preview" id="preview_warning"></span>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Danger 색상</label>
                            <div class="input-group">
                                <input type="color" id="color_danger" value="#dc3545">
                                <input type="text" class="form-control" id="color_danger_text" value="#dc3545">
                                <span class="color-preview" id="preview_danger"></span>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Light 색상</label>
                            <div class="input-group">
                                <input type="color" id="color_light" value="#f8f9fa">
                                <input type="text" class="form-control" id="color_light_text" value="#f8f9fa">
                                <span class="color-preview" id="preview_light"></span>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Dark 색상</label>
                            <div class="input-group">
                                <input type="color" id="color_dark" value="#212529">
                                <input type="text" class="form-control" id="color_dark_text" value="#212529">
                                <span class="color-preview" id="preview_dark"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Step 4: Security -->
            <div class="step-content" id="step4">
                <h3><i class="bi bi-shield-check"></i> 보안 설정</h3>
                <p class="text-muted">보안 관련 설정을 확인하세요.</p>
                
                <div class="row mt-4">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">세션 유효 시간</label>
                            <div class="input-group">
                                <input type="number" class="form-control" id="session_lifetime" value="7200">
                                <span class="input-group-text">초</span>
                            </div>
                            <small class="form-text">기본: 7200초 (2시간)</small>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">비활동 타임아웃</label>
                            <div class="input-group">
                                <input type="number" class="form-control" id="session_timeout" value="1800">
                                <span class="input-group-text">초</span>
                            </div>
                            <small class="form-text">기본: 1800초 (30분)</small>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">CSRF 토큰 유효 시간</label>
                            <div class="input-group">
                                <input type="number" class="form-control" id="csrf_lifetime" value="3600">
                                <span class="input-group-text">초</span>
                            </div>
                            <small class="form-text">기본: 3600초 (1시간)</small>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">최대 업로드 크기</label>
                            <div class="input-group">
                                <input type="number" class="form-control" id="upload_max_size" value="5">
                                <span class="input-group-text">MB</span>
                            </div>
                            <small class="form-text">파일 업로드 최대 크기</small>
                        </div>
                    </div>
                </div>
                
                <div class="alert alert-warning mt-4">
                    <i class="bi bi-exclamation-triangle alert-icon"></i>
                    <strong>보안 권장사항:</strong>
                    <ul class="mb-0 mt-2">
                        <li>운영 환경에서는 디버그 모드를 반드시 비활성화하세요</li>
                        <li>강력한 데이터베이스 비밀번호를 사용하세요</li>
                        <li>정기적으로 세션 설정을 검토하세요</li>
                    </ul>
                </div>
            </div>
            
            <!-- Step 5: Download -->
            <div class="step-content" id="step5">
                <h3><i class="bi bi-download"></i> 설정 파일 다운로드</h3>
                <p class="text-muted">설정이 완료되었습니다. 아래 파일들을 다운로드하세요.</p>
                
                <div class="download-section">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="file-icon">
                                <i class="bi bi-file-earmark-code"></i>
                            </div>
                            <h5>config.php</h5>
                            <p class="text-muted">환경 변수 로더</p>
                            <button class="btn btn-primary download-button" onclick="downloadConfig()">
                                <i class="bi bi-download"></i> 다운로드
                            </button>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="file-icon">
                                <i class="bi bi-file-earmark-code"></i>
                            </div>
                            <h5>database.php</h5>
                            <p class="text-muted">데이터베이스 설정</p>
                            <button class="btn btn-primary download-button" onclick="downloadDatabase()">
                                <i class="bi bi-download"></i> 다운로드
                            </button>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="file-icon">
                                <i class="bi bi-file-earmark-code"></i>
                            </div>
                            <h5>app.php</h5>
                            <p class="text-muted">애플리케이션 설정</p>
                            <button class="btn btn-primary download-button" onclick="downloadApp()">
                                <i class="bi bi-download"></i> 다운로드
                            </button>
                        </div>
                    </div>
                    
                    <div class="row mt-4">
                        <div class="col-md-12">
                            <div class="file-icon">
                                <i class="bi bi-file-earmark-text"></i>
                            </div>
                            <h5>.env</h5>
                            <p class="text-muted">환경 변수 파일</p>
                            <button class="btn btn-success download-button" onclick="downloadEnv()">
                                <i class="bi bi-download"></i> .env 파일 다운로드
                            </button>
                        </div>
                    </div>
                    
                    <button class="btn btn-lg btn-warning mt-4" onclick="downloadAll()">
                        <i class="bi bi-file-earmark-zip"></i> 모든 파일 다운로드
                    </button>
                </div>
                
                <div class="installation-guide">
                    <h5><i class="bi bi-book"></i> 설치 가이드</h5>
                    <ol>
                        <li><strong>파일 배치:</strong> 다운로드한 파일들을 다음 위치에 배치하세요:
                            <ul>
                                <li><code>config.php</code> → <code>/admin/config/</code></li>
                                <li><code>database.php</code> → <code>/admin/config/</code></li>
                                <li><code>app.php</code> → <code>/admin/config/</code></li>
                                <li><code>.env</code> → <code>/admin/</code></li>
                            </ul>
                        </li>
                        <li><strong>폴더 생성:</strong> <code>/admin/config/</code> 폴더가 없다면 생성하세요</li>
                        <li><strong>권한 설정:</strong> 파일 권한을 644로 설정하세요 (Unix/Linux)</li>
                        <li><strong>데이터베이스:</strong> MySQL에서 지정한 데이터베이스를 생성하세요</li>
                        <li><strong>테스트:</strong> 브라우저에서 admin 페이지에 접속해 확인하세요</li>
                    </ol>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <div class="wizard-footer">
            <button class="btn btn-secondary" id="btnPrev" onclick="prevStep()" style="display: none;">
                <i class="bi bi-arrow-left"></i> 이전
            </button>
            <button class="btn btn-primary" id="btnNext" onclick="nextStep()">
                다음 <i class="bi bi-arrow-right"></i>
            </button>
        </div>
    </div>
    
    <script>
        let currentStep = 1;
        const totalSteps = 5;
        
        // 색상 프리셋
        const presets = {
            bootstrap: {
                primary: '#0d6efd',
                secondary: '#6c757d',
                success: '#198754',
                info: '#0dcaf0',
                warning: '#ffc107',
                danger: '#dc3545',
                light: '#f8f9fa',
                dark: '#212529'
            },
            material: {
                primary: '#2196F3',
                secondary: '#FF4081',
                success: '#4CAF50',
                info: '#00BCD4',
                warning: '#FF9800',
                danger: '#F44336',
                light: '#F5F5F5',
                dark: '#212121'
            },
            dark: {
                primary: '#BB86FC',
                secondary: '#03DAC6',
                success: '#00C853',
                info: '#00B0FF',
                warning: '#FFD600',
                danger: '#CF6679',
                light: '#424242',
                dark: '#121212'
            },
            custom: {
                primary: '#007bff',
                secondary: '#6610f2',
                success: '#28a745',
                info: '#17a2b8',
                warning: '#ffc107',
                danger: '#dc3545',
                light: '#f8f9fa',
                dark: '#343a40'
            }
        };
        
        // 초기화
        document.addEventListener('DOMContentLoaded', function() {
            updateColorPreviews();
            setupColorSync();
        });
        
        // 색상 동기화 설정
        function setupColorSync() {
            const colors = ['primary', 'secondary', 'success', 'info', 'warning', 'danger', 'light', 'dark'];
            colors.forEach(color => {
                const colorInput = document.getElementById(`color_${color}`);
                const textInput = document.getElementById(`color_${color}_text`);
                const preview = document.getElementById(`preview_${color}`);
                
                colorInput.addEventListener('input', function() {
                    textInput.value = this.value;
                    preview.style.backgroundColor = this.value;
                });
                
                textInput.addEventListener('input', function() {
                    colorInput.value = this.value;
                    preview.style.backgroundColor = this.value;
                });
                
                // 초기 미리보기 설정
                preview.style.backgroundColor = colorInput.value;
            });
        }
        
        // 색상 미리보기 업데이트
        function updateColorPreviews() {
            const colors = ['primary', 'secondary', 'success', 'info', 'warning', 'danger', 'light', 'dark'];
            colors.forEach(color => {
                const preview = document.getElementById(`preview_${color}`);
                const input = document.getElementById(`color_${color}`);
                if (preview && input) {
                    preview.style.backgroundColor = input.value;
                }
            });
        }
        
        // 프리셋 적용
        function applyPreset(presetName) {
            const preset = presets[presetName];
            Object.keys(preset).forEach(color => {
                const colorInput = document.getElementById(`color_${color}`);
                const textInput = document.getElementById(`color_${color}_text`);
                const preview = document.getElementById(`preview_${color}`);
                
                if (colorInput) {
                    colorInput.value = preset[color];
                    textInput.value = preset[color];
                    preview.style.backgroundColor = preset[color];
                }
            });
        }
        
        // 단계 이동
        function nextStep() {
            if (currentStep < totalSteps) {
                // 현재 단계 검증
                if (!validateStep(currentStep)) {
                    return;
                }
                
                // 단계 변경
                document.querySelector(`.wizard-step[data-step="${currentStep}"]`).classList.add('completed');
                document.querySelector(`.wizard-step[data-step="${currentStep}"]`).classList.remove('active');
                document.getElementById(`step${currentStep}`).classList.remove('active');
                
                currentStep++;
                
                document.querySelector(`.wizard-step[data-step="${currentStep}"]`).classList.add('active');
                document.getElementById(`step${currentStep}`).classList.add('active');
                
                updateButtons();
            }
        }
        
        function prevStep() {
            if (currentStep > 1) {
                document.querySelector(`.wizard-step[data-step="${currentStep}"]`).classList.remove('active');
                document.getElementById(`step${currentStep}`).classList.remove('active');
                
                currentStep--;
                
                document.querySelector(`.wizard-step[data-step="${currentStep}"]`).classList.add('active');
                document.querySelector(`.wizard-step[data-step="${currentStep}"]`).classList.remove('completed');
                document.getElementById(`step${currentStep}`).classList.add('active');
                
                updateButtons();
            }
        }
        
        // 버튼 상태 업데이트
        function updateButtons() {
            const btnPrev = document.getElementById('btnPrev');
            const btnNext = document.getElementById('btnNext');
            
            if (currentStep === 1) {
                btnPrev.style.display = 'none';
            } else {
                btnPrev.style.display = 'block';
            }
            
            if (currentStep === totalSteps) {
                btnNext.style.display = 'none';
            } else {
                btnNext.style.display = 'block';
            }
        }
        
        // 단계별 검증
        function validateStep(step) {
            switch(step) {
                case 1:
                    // 데이터베이스 검증
                    if (!document.getElementById('db_name').value) {
                        alert('데이터베이스명을 입력하세요.');
                        return false;
                    }
                    if (!document.getElementById('db_user').value) {
                        alert('사용자명을 입력하세요.');
                        return false;
                    }
                    break;
                case 2:
                    // 애플리케이션 검증
                    if (!document.getElementById('app_name').value) {
                        alert('애플리케이션 이름을 입력하세요.');
                        return false;
                    }
                    if (!document.getElementById('admin_email').value) {
                        alert('관리자 이메일을 입력하세요.');
                        return false;
                    }
                    break;
            }
            return true;
        }
        
        // 스텝 클릭 이동
        document.querySelectorAll('.wizard-step').forEach(step => {
            step.addEventListener('click', function() {
                const targetStep = parseInt(this.dataset.step);
                if (targetStep < currentStep || this.classList.contains('completed')) {
                    // 이전 단계나 완료된 단계로만 이동 가능
                    document.querySelector(`.wizard-step[data-step="${currentStep}"]`).classList.remove('active');
                    document.getElementById(`step${currentStep}`).classList.remove('active');
                    
                    currentStep = targetStep;
                    
                    this.classList.add('active');
                    this.classList.remove('completed');
                    document.getElementById(`step${targetStep}`).classList.add('active');
                    
                    updateButtons();
                }
            });
        });
        
        // 파일 생성 함수들
        function generateConfigPhp() {
            return `<?php
/**
 * Admin System Configuration Loader
 * 환경 변수 및 설정 관리 시스템
 */

class Config {
    private static $env = [];
    private static $loaded = false;
    
    /**
     * 환경 변수 로드
     */
    public static function load($envFile = null) {
        if (self::$loaded) {
            return;
        }
        
        // 기본 .env 파일 경로
        if ($envFile === null) {
            $envFile = dirname(__DIR__) . '/.env';
        }
        
        // .env 파일이 없으면 .env.example 사용 (개발 편의)
        if (!file_exists($envFile)) {
            $envExampleFile = dirname(__DIR__) . '/.env.example';
            if (file_exists($envExampleFile)) {
                $envFile = $envExampleFile;
            } else {
                return;
            }
        }
        
        // .env 파일 파싱
        $lines = file($envFile, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);
        foreach ($lines as $line) {
            // 주석 제거
            if (strpos(trim($line), '#') === 0) {
                continue;
            }
            
            // KEY=VALUE 형식 파싱
            if (strpos($line, '=') !== false) {
                list($key, $value) = explode('=', $line, 2);
                $key = trim($key);
                $value = trim($value);
                
                // 따옴표 제거
                if ((substr($value, 0, 1) === '"' && substr($value, -1) === '"') ||
                    (substr($value, 0, 1) === "'" && substr($value, -1) === "'")) {
                    $value = substr($value, 1, -1);
                }
                
                self::$env[$key] = $value;
                
                // 실제 환경 변수로도 설정 (getenv() 호환성)
                putenv("$key=$value");
                $_ENV[$key] = $value;
            }
        }
        
        self::$loaded = true;
    }
    
    /**
     * 환경 변수 가져오기
     */
    public static function get($key, $default = null) {
        if (!self::$loaded) {
            self::load();
        }
        
        // 우선순위: 1. 실제 환경변수, 2. .env 파일, 3. 기본값
        if (isset($_ENV[$key])) {
            return $_ENV[$key];
        }
        
        if (isset(self::$env[$key])) {
            return self::$env[$key];
        }
        
        return $default;
    }
    
    /**
     * 모든 환경 변수 가져오기
     */
    public static function all() {
        if (!self::$loaded) {
            self::load();
        }
        
        return self::$env;
    }
    
    /**
     * 환경 확인
     */
    public static function isLocal() {
        return self::get('APP_ENV', 'production') === 'local';
    }
    
    public static function isProduction() {
        return self::get('APP_ENV', 'production') === 'production';
    }
    
    public static function isDebug() {
        return self::get('APP_DEBUG', 'false') === 'true';
    }
}

/**
 * 헬퍼 함수 - 환경 변수 가져오기
 */
if (!function_exists('env')) {
    function env($key, $default = null) {
        return Config::get($key, $default);
    }
}

/**
 * 헬퍼 함수 - 설정값 가져오기
 */
if (!function_exists('config')) {
    function config($key, $default = null) {
        // config 파일에서 설정 가져오기
        $parts = explode('.', $key);
        $file = array_shift($parts);
        
        $configFile = __DIR__ . '/' . $file . '.php';
        if (file_exists($configFile)) {
            $config = require $configFile;
            
            // 중첩된 키 처리 (예: database.connections.mysql)
            foreach ($parts as $part) {
                if (isset($config[$part])) {
                    $config = $config[$part];
                } else {
                    return $default;
                }
            }
            
            return $config;
        }
        
        return $default;
    }
}

// 자동 로드
Config::load();`;
        }
        
        function generateDatabasePhp() {
            return `<?php
/**
 * Database Configuration
 * 데이터베이스 설정 파일
 */

return [
    // 기본 연결
    'default' => env('DB_CONNECTION', 'mysql'),
    
    // 테이블 프리픽스
    'prefix' => env('DB_PREFIX', ''),
    
    // 연결 설정
    'connections' => [
        'mysql' => [
            'driver' => 'mysql',
            'host' => env('DB_HOST', 'localhost'),
            'port' => env('DB_PORT', 3306),
            'database' => env('DB_DATABASE', ''),
            'username' => env('DB_USERNAME', 'root'),
            'password' => env('DB_PASSWORD', ''),
            'charset' => env('DB_CHARSET', 'utf8mb4'),
            'collation' => env('DB_COLLATION', 'utf8mb4_unicode_ci'),
            'socket' => env('DB_SOCKET', ''),
            'options' => [
                PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
                PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC,
                PDO::ATTR_EMULATE_PREPARES => false,
            ],
        ],
    ],
    
    // 마이그레이션 테이블
    'migrations_table' => 'migrations',
];`;
        }
        
        function generateAppPhp() {
            const appName = document.getElementById('app_name').value;
            const appEnv = document.getElementById('app_env').value;
            const appDebug = document.getElementById('app_debug').value;
            const appUrl = document.getElementById('app_url').value;
            const siteName = document.getElementById('site_name').value;
            const adminEmail = document.getElementById('admin_email').value;
            
            return `<?php
/**
 * Application Configuration
 * 애플리케이션 전반 설정
 */

return [
    // 애플리케이션 정보
    'name' => env('APP_NAME', '${appName}'),
    'env' => env('APP_ENV', '${appEnv}'),
    'debug' => env('APP_DEBUG', ${appDebug}) === 'true',
    'url' => env('APP_URL', '${appUrl}'),
    
    // 기본 사이트 설정
    'defaults' => [
        'site_name' => env('DEFAULT_SITE_NAME', '${siteName}'),
        'site_description' => env('DEFAULT_SITE_DESCRIPTION', 'Administrative Management System'),
        'admin_email' => env('DEFAULT_ADMIN_EMAIL', '${adminEmail}'),
    ],
    
    // 보안 설정
    'security' => [
        'session_lifetime' => env('SESSION_LIFETIME', ${document.getElementById('session_lifetime').value}),
        'session_timeout' => env('SESSION_TIMEOUT', ${document.getElementById('session_timeout').value}),
        'csrf_token_lifetime' => env('CSRF_TOKEN_LIFETIME', ${document.getElementById('csrf_lifetime').value}),
    ],
    
    // 파일 업로드 설정
    'upload' => [
        'max_size' => env('UPLOAD_MAX_SIZE', ${document.getElementById('upload_max_size').value * 1048576}), // ${document.getElementById('upload_max_size').value}MB
        'path' => env('UPLOAD_PATH', 'uploads/'),
        'allowed_types' => ['jpg', 'jpeg', 'png', 'gif', 'pdf', 'doc', 'docx', 'xlsx'],
    ],
    
    // 테마 설정
    'theme' => [
        'primary_color' => env('THEME_PRIMARY_COLOR', '${document.getElementById('color_primary').value}'),
        'secondary_color' => env('THEME_SECONDARY_COLOR', '${document.getElementById('color_secondary').value}'),
        'success_color' => env('THEME_SUCCESS_COLOR', '${document.getElementById('color_success').value}'),
        'info_color' => env('THEME_INFO_COLOR', '${document.getElementById('color_info').value}'),
        'warning_color' => env('THEME_WARNING_COLOR', '${document.getElementById('color_warning').value}'),
        'danger_color' => env('THEME_DANGER_COLOR', '${document.getElementById('color_danger').value}'),
        'light_color' => env('THEME_LIGHT_COLOR', '${document.getElementById('color_light').value}'),
        'dark_color' => env('THEME_DARK_COLOR', '${document.getElementById('color_dark').value}'),
    ],
    
    // 로깅 설정
    'logging' => [
        'level' => env('LOG_LEVEL', 'info'),
        'path' => env('LOG_PATH', '../logs/'),
    ],
];`;
        }
        
        function generateEnv() {
            const now = new Date().toISOString();
            return `# Admin System Environment Configuration
# Generated at ${now}

# Database Settings
DB_HOST=${document.getElementById('db_host').value}
DB_PORT=${document.getElementById('db_port').value}
DB_DATABASE=${document.getElementById('db_name').value}
DB_USERNAME=${document.getElementById('db_user').value}
DB_PASSWORD=${document.getElementById('db_password').value}
DB_PREFIX=${document.getElementById('db_prefix').value}
DB_CHARSET=${document.getElementById('db_charset').value}
DB_COLLATION=${document.getElementById('db_charset').value}_unicode_ci
DB_SOCKET=${document.getElementById('db_socket').value}

# Application Settings
APP_NAME="${document.getElementById('app_name').value}"
APP_ENV=${document.getElementById('app_env').value}
APP_DEBUG=${document.getElementById('app_debug').value}
APP_URL=${document.getElementById('app_url').value}
DEFAULT_SITE_NAME="${document.getElementById('site_name').value}"
DEFAULT_SITE_DESCRIPTION="Administrative Management System"
DEFAULT_ADMIN_EMAIL=${document.getElementById('admin_email').value}

# Theme Settings
THEME_PRIMARY_COLOR=${document.getElementById('color_primary').value}
THEME_SECONDARY_COLOR=${document.getElementById('color_secondary').value}
THEME_SUCCESS_COLOR=${document.getElementById('color_success').value}
THEME_INFO_COLOR=${document.getElementById('color_info').value}
THEME_WARNING_COLOR=${document.getElementById('color_warning').value}
THEME_DANGER_COLOR=${document.getElementById('color_danger').value}
THEME_LIGHT_COLOR=${document.getElementById('color_light').value}
THEME_DARK_COLOR=${document.getElementById('color_dark').value}

# Security Settings
SESSION_LIFETIME=${document.getElementById('session_lifetime').value}
SESSION_TIMEOUT=${document.getElementById('session_timeout').value}
CSRF_TOKEN_LIFETIME=${document.getElementById('csrf_lifetime').value}

# Upload Settings
UPLOAD_MAX_SIZE=${document.getElementById('upload_max_size').value * 1048576}
UPLOAD_PATH=uploads/

# Logging Settings
LOG_LEVEL=info
LOG_PATH=../logs/`;
        }
        
        // 다운로드 함수들
        function download(filename, content) {
            const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = filename;
            link.click();
        }
        
        function downloadConfig() {
            download('config.php', generateConfigPhp());
        }
        
        function downloadDatabase() {
            download('database.php', generateDatabasePhp());
        }
        
        function downloadApp() {
            download('app.php', generateAppPhp());
        }
        
        function downloadEnv() {
            download('.env', generateEnv());
        }
        
        function downloadAll() {
            setTimeout(() => downloadConfig(), 100);
            setTimeout(() => downloadDatabase(), 300);
            setTimeout(() => downloadApp(), 500);
            setTimeout(() => downloadEnv(), 700);
        }
    </script>
</body>
</html>